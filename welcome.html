<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Elegant Tailoring</title>
    <link rel="stylesheet" href="welcome.css" />
    <link rel="icon" type="image/png" href="home.png" />
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet" />

    <script>
        // Prevent back navigation
        sessionStorage.setItem("visitedWelcome", "true");

        function lockPage() {
            history.pushState(null, "", location.href);
        }
        lockPage();
        window.addEventListener("popstate", function() {
            lockPage();
        });

        document.addEventListener("keydown", function(e) {
            if (e.key === "ArrowLeft" || e.key === "ArrowRight") {
                e.preventDefault();
            }
        });
    </script>
</head>

<body>

    <!-- Floating Circular Menu -->
    <div class="main">
        <div class="menu-btn" id="menu-btn">
            <ion-icon name="menu-outline"></ion-icon>
        </div>
        <div class="menu" id="menu">
            <span><a href="#home-section"><ion-icon name="home-outline"></ion-icon></a></span>
            <span><a href="#about-section"><ion-icon name="person-outline"></ion-icon></a></span>
            <span><a href="#login-section"><ion-icon name="log-in-outline"></ion-icon></a></span>
            <span><a href="#services-section"><ion-icon name="settings-outline"></ion-icon></a></span>
            <span><a href="register.html"><ion-icon name="person-add-outline"></ion-icon></a></span>
            <span><a href="./forgot.html"><ion-icon name="help-outline"></ion-icon></a></span>
        </div>
    </div>

    <!-- Sections -->
    <section class="home-section" id="home-section">
        <h1>Welcome to Elegant Tailoring</h1>
        <p>Experience luxury and precision with our expert tailoring for all ages.</p>
    </section>

    <section class="about-section" id="about-section">
        <h2>About Us</h2>
        <p>With 25+ years of experience, Trinadha Rao brings premium custom tailoring, alterations, and fashion design under one roof. Expect perfect fits and timely service.</p>
        <img src="img.jpg" alt="Tailor at work" class="about-image">
    </section>

    <section class="login-section" id="login-section">
        <div class="login-container">
            <h2>Login</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label for="username">Username (Gmail only)</label>
                    <input type="text" id="username" name="username" placeholder="example@gmail.com" required />
                </div>
                <div class="form-group">
                    <label for="password">Password (6-digit number)</label>
                    <input type="password" id="password" name="password" placeholder="Enter 6-digit password" required />
                </div>
                <button type="submit" class="login-button">Login</button>
                <p id="message"></p>
            </form>
            <div class="extra-links">
                <a href="./forgot.html">Forgot password?</a> |
                <a href="register.html">Sign up</a>
            </div>
        </div>
    </section>

    <section class="services-section" id="services-section">
        <h2>Our Services</h2>
        <p>Custom stitching, intricate embroidery, quality alterations and more — for men, women, and kids.</p>
    </section>

    <!-- Back Button -->
    <a href="index.html" class="back-btn" onclick="sessionStorage.removeItem('visitedWelcome')">⬅ Back</a>

    <!-- Ionicons -->
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

    <!-- Circular Menu Script -->
    <script>
        const menuBtn = document.getElementById("menu-btn");
        const menu = document.getElementById("menu");

        menuBtn.addEventListener("click", () => {
            menuBtn.classList.toggle("active");
            menu.classList.toggle("active");
        });

        // Login validation
        (function() {
            const messageEl = document.getElementById("message");

            if (sessionStorage.getItem("loggedIn") === "true") {
                window.location.href = "next.html";
                return;
            }

            const storedUser = JSON.parse(localStorage.getItem("registeredUser"));
            if (!storedUser && messageEl) {
                messageEl.textContent = "No account found. Please register first.";
                messageEl.style.color = "red";
            }

            document.getElementById("loginForm").addEventListener("submit", function(event) {
                event.preventDefault();
                const username = document.getElementById("username").value.trim();
                const password = document.getElementById("password").value;
                const storedUser = JSON.parse(localStorage.getItem("registeredUser"));

                if (!storedUser) {
                    messageEl.textContent = "No account found. Please register first.";
                    messageEl.style.color = "red";
                    setTimeout(() => window.location.href = "register.html", 1400);
                    return;
                }

                const gmailPattern = /^[a-zA-Z0-9._%+-]+@gmail\.com$/;
                if (!gmailPattern.test(username)) {
                    messageEl.textContent = "Please enter a valid Gmail address.";
                    messageEl.style.color = "red";
                    return;
                }
                if (username !== storedUser.email) {
                    messageEl.textContent = "This email is not registered.";
                    messageEl.style.color = "red";
                    return;
                }
                if (password !== storedUser.password) {
                    messageEl.textContent = "Password is incorrect.";
                    messageEl.style.color = "red";
                    return;
                }

                sessionStorage.setItem("loggedIn", "true");
                window.location.href = "next.html";
            });
        })();
    </script>
</body>

</html>